{% extends '::frontend.html.twig' %}

{% block routes 'active' %}

{% block article %}

<div class="title-block">
    {% if app.user %} <button type="button" class="btn btn-small pull-right">Crear ruta <i class="icon-plus"></i></button> {% endif %}
    <h2>Rutas</h2>
</div>

{# if app.user %}
<form onSubmit="var submit = document.getElementById('RouteSubmit'); submit.disabled = 'disabled'; submit.innerHTML = 'Subiendo...';" action="{{ path('ColectaRouteUpload') }}" method="POST" class="form-horizontal well hidden" onclick="this.className='form-horizontal well'" enctype="multipart/form-data">
<h2>Crear una nueva Ruta</h2>
    <fieldset>
      <div class="control-group">
        <label class="control-label" for="RouteFile">Archivo</label>
        <div class="controls">
          <input type="file" id="RouteFile" name="file">
        </div>
      </div>
      
      <div class="form-actions">
        <button id="RouteSubmit" type="submit" class="btn btn-primary">Subir e introducir datos</button>
      </div>
    </fieldset>
</form>
{% endif #}

{% for item in items %}
<div class="item">
    {% include 'ColectaItemBundle:Default:itemheader.html.twig' with { 'item': item } only %}
    
    {% set path = 'Colecta' ~ item.type ~ ':mini.html.twig' %}
    {% set path = path | replace({'/':'Bundle:'}) %}
    {% include path with { 'item': item } only %}
    
    {% include 'ColectaItemBundle:Comment:comments.html.twig' with { 'comments': item.comments, item: item } only %}
</div>
{% else %}
<h2>No hay ninguna ruta.</h2>
{% endfor %}

<ul class="pager">
  <li class="previous{% if page == 1 %} disabled{% endif %}">
    <a href="{% if page > 1 %}{{ path('ColectaRoutePage', {'page': page - 1 }) }}{% else %}{% endif %}">&larr; Anteriores</a>
  </li>
  <li class="next{% if not thereAreMore %} disabled{% endif %}">
    <a href="{% if thereAreMore %}{{ path('ColectaRoutePage', {'page': page + 1 }) }}{% else %}{% endif %}">Siguientes &rarr;</a>
  </li>
</ul>

{% endblock %}