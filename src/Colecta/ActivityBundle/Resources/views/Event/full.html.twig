{% extends '::frontend.html.twig' %}

{% block events 'active' %}

{% block article %}
<div class="event full">
    
    {% include 'ColectaItemBundle:Default:itemheader.html.twig' with { 'item': item } only %}
    
    <div class="date">
        <span class="weekday">{{ item.dateini | date('l') | replace ({
            'Monday':'Lunes',
            'Tuesday':'Martes',
            'Wednesday':'Miércoles',
            'Thursday':'Jueves',
            'Friday':'Viernes',
            'Saturday':'Sábado',
            'Sunday':'Domingo'
        }) }}</span>
        <span class="monthday">{{ item.dateini | date('d') }}</span> 
        <span class="month">{% set month = item.dateini | date('n') | replace({
            '1':'Enero',
            '2':'Febrero',
            '3':'Marzo',
            '4':'Abril',
            '5':'Mayo',
            '6':'Junio',
            '7':'Julio',
            '8':'Agosto',
            '9':'Septiembre',
            '10':'Octubre',
            '11':'Noviembre',
            '12':'Diciembre'
        }) %}{% if item.dateini | date('Y') == 'today' | date('Y') %}{{month}}{% else %}{{ month | slice(0,3) ~ ' ' ~ item.dateini | date('Y') }}{% endif %}</span>
        <span class="hour">{{ item.dateini | date('H:i') }}</span>
    </div>
    
    <h2>{{ item.name }}</h2>
    <p>{{ item.description | nl2br }}</p>
    
    {% include 'ColectaActivityBundle:Default:properties.html.twig' with { item: item } only %}
    
    {# ASSISTANCES #}
    <div class="assistances">
    <h2>Van a asistir</h2>
    
    <ul class="unstyled">    
    {% for assistance in item.assistances %}
        <li class="{% if loop.index is odd %}odd{% else %}even{% endif %}"><a class="username" href="{{ path('userProfile', { 'id': assistance.user.id }) }}"><img width="20" height="20" src="{{assistance.user.avatar}}"> {{assistance.user.name}}</a> va a asistir</li>
    {% else %}
        <li><em>Ninguna asistencia confirmada</em></li>
    {% endfor %}
    
    </ul>
    
    {% if item.author == app.user %}<p><a class="btn btn-small" href="/event/inventado/edit/">Gestionar asistencias</a></p>{% endif %}
    
    </div>
    
    
    {% include 'ColectaItemBundle:Comment:comments.html.twig' with { 'comments': item.comments, item: item } only %}
    
</div>
{% endblock %}